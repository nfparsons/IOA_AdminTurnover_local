---
title: "Admin Turnover Codebook"
output:
  bookdown::word_document2: 
    number_sections: false
    toc: true
  bookdown::html_document2: 
    number_sections: false
    toc: true
  tufte::tufte_handout: 
    number_sections: false
    toc: true
  tufte::tufte_html: 
    number_sections: false
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE, # show warnings 
  message = FALSE, # show messages 
  error = FALSE, # do not interrupt in case of errors,
  eval = TRUE,
  echo = FALSE  # show R code
)
ggplot2::theme_set(ggplot2::theme_bw())

if (!require("pacman")) 
  install.packages("pacman", repos = "https://cran.rstudio.org")

p_load(here, 
       skimr, 
       haven,
       readxl, 
       janitor, 
       scales,
       bookdown,
       naniar, # replace_with_na()
       labelled,
       flextable, 
       showtext, 
       tidyverse, 
       lubridate,
       GGally)

here::i_am("archive/here_anchor.R")
setwd(here())

showtext_auto()

rm(list = ls())

## Load data
data <-
  read_dta("data/AdminTurnover_Survey_Data_012721_020221_USE_THIS.dta") |>
  
  ## reformat name strings
  mutate(
    firstname = tolower(str_trim(firstname)),
    lastname = tolower(str_trim(lastname)),
    ccmu1 = toupper(str_trim(ccmu1))
  ) |>
  
  ## join Admin turnover data
  left_join(
    read_csv(here("data", "AdTurn List 021622.csv")) |>
      filter(is.na(NoAdminRecord)) |>
      mutate(
        firstname = tolower(str_trim(firstname)),
        lastname = tolower(str_trim(lastname)),
        ccmu1 = toupper(str_trim(ccmu1))
      ),
    by = c(
      "firstname" = "firstname",
      "lastname" = "lastname",
      "ccmu1" = "ccmu1", 
      "fac1" = "fac1"
    )
  ) |>
  
  ## join Facility turnover data
  left_join(
    read_excel(here("data", "CBC Administrator List 01010-062519_032720_021522.xlsx")) |> 
  group_by(FACID) |> 
  summarize(n = n(), 
            early = min(STARTED)) |> 
  ungroup() |> 
  mutate(start_year = lubridate::year(lubridate::ymd(early)), 
         end_year = 2021, 
         span = end_year - start_year, 
         turnover_ratio = n / span), 
  by = c("ccmu1" = "FACID")
  ) |> 
  
  ## select columns for analysis
  select(firstname,
         lastname,
         start, 
         end_100121, 
         ccmu1,
         fac1, 
         Beds,
         turnover_ratio,
         Finished,
         ResponseId,
         starts_with("Q")) |>
  
  ## do some cleaning
  select(-Q) |>
  replace_with_na_all(condition = ~ .x %in% c(-99, "")) |>
  filter(!is.na(Finished)) |> 
  rename(first_name = firstname, 
         last_name = lastname, 
         position_start = start, 
         position_end = end_100121, 
         ccmu = ccmu1, 
         facility_name = fac1, 
         facility_beds = Beds, 
         facility_turnover = turnover_ratio, 
         survey_complete = Finished, 
         response_id = ResponseId)

write_csv(data, here("data", "admin_turnover_analysis.csv"))

write_dta(data, here("data", "admin_turnover_analysis.dta"))
```


```{r facility_beds prep}
data.facility_beds <- skim(data$facility_beds) |>
  as_tibble() |>
  transmute(
    Variable = "facility_beds",
    Missing = n_missing,
    Freq = percent(complete_rate, accuracy = 0.1),
    Mean = round(numeric.mean, 1),
    SD = round(numeric.sd, 1), 
    P0 = numeric.p0,
    P25 = numeric.p25,
    P50 = numeric.p50,
    P75 = numeric.p75,
    P100 = numeric.p100
  ) 
```


```{r facility_turnover prep}
data.facility_turnover <- skim(data$facility_turnover) |>
  as_tibble() |>
  transmute(
    Variable = "facility_turnover",
    Missing = n_missing,
    Freq = percent(complete_rate, accuracy = 0.1),
    Mean = round(numeric.mean, 1),
    SD = round(numeric.sd, 1), 
    P0 = round(numeric.p0, 1), 
    P25 = round(numeric.p25, 1), 
    P50 = round(numeric.p50, 1), 
    P75 = round(numeric.p75, 1), 
    P100 = round(numeric.p100, 1)
  ) 
```


```{r Q01 prep}
data.Q01 <- data |>
  select(Q1) |>
  mutate(response = replace_na(Q1, -99)) |> 
  group_by(response) |> 
  summarise(n = n()) |> 
  transmute(Variable = c("Q1", "", "", ""), 
            Option = "", 
            Response = case_when(response == -99 ~ "[-99, NA] Missing", 
                                  response == 1 ~ "[1] Male", 
                                  response == 2 ~ "[2] Female", 
                                  response == 3 ~ "[3] Prefer to self-describe", 
                                  response == 4 ~ "[4] Prefer not to answer"), 
            N = n, 
            `Freq` = percent(n/sum(n))
            ) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[3] Prefer to self-describe", 
          N = 0, 
          Freq = "0.00%") |> 
  arrange(Response)
```


```{r Q02 prep}
data.Q02 <- skim(data$Q2) |>
  as_tibble() |>
  transmute(
    Variable = "Q2",
    Missing = n_missing,
    Freq = percent(complete_rate, accuracy = 0.1),
    Mean = round(numeric.mean, 1),
    SD = round(numeric.sd, 1), 
    P0 = numeric.p0,
    P25 = numeric.p25,
    P50 = numeric.p50,
    P75 = numeric.p75,
    P100 = numeric.p100
  ) 
```


```{r Q03 prep}
data.Q03 <- data |>
  select(starts_with("Q3")) |>
  select(-Q3_7_TEXT) |> 
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |> 
  mutate(Q3_0 = case_when(is.na(Q3_1) & is.na(Q3_2) & is.na(Q3_3) & is.na(Q3_4) & is.na(Q3_5) & is.na(Q3_6) & is.na(Q3_7) ~ 1, 
                          TRUE ~ NA_real_)) |> 
  summarise(across(everything(), ~ sum(., na.rm = TRUE))) |> 
  select(Q3_0, everything()) |> 
  pivot_longer(cols = everything(), 
               names_to = "variable", 
               values_to = "n") |> 
  transmute(Variable = variable, 
            Option = "", 
            Response = case_when(variable == "Q3_0" ~ "[-99, NA] Missing", 
                                  variable == "Q3_1" ~ "[1] American Indian or Alaska Native", 
                                  variable == "Q3_2" ~ "[1] Asian", 
                                  variable == "Q3_3" ~ "[1] Black or African American", 
                                  variable == "Q3_4" ~ "[1] Hispanic or Latino", 
                                  variable == "Q3_5" ~ "[1] Native Hawaiian or Other Pacific Islander", 
                                  variable == "Q3_6" ~ "[1] White", 
                                  variable == "Q3_7" ~ "[1] Other"),
            N = n, 
            Freq = percent(n/sum(n))
            ) |> 
  mutate(Variable = replace(Variable, Variable == "Q3_0", ""))
```


```{r Q04 prep}
data.Q04 <- data |>
  select(Q4) |>
  mutate(response = replace_na(Q4, -99)) |> 
  group_by(response) |> 
  summarise(n = n()) |> 
  transmute(Variable = c("Q4", "", "", "", "", "", ""), 
            Option = "", 
            Response = case_when(response == -99 ~ "[-99, NA] Missing", 
                                  response == 1 ~ "[1] High school diploma or equivalent (such as GED)", 
                                  response == 2 ~ "[2] Some college credit, but not degree", 
                                  response == 3 ~ "[3] Associate's degree (for example: AA, AS)", 
                                  response == 4 ~ "[4] Bachelor's degree (for example: BA, BS)", 
                                  response == 5 ~ "[5] Master's degree (for example: MA, MS, MEng, MSW, MBA)", 
                                  response == 6 ~ "[6] Professional degree beyond a Bachelor's Degree (for example: MD, JD)", 
                                  response == 7 ~ "[7] Doctorate degree (for example: PhD, EdD)"
                                  ), 
            N = n, 
            Freq = percent(n/sum(n))
            ) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Professional degree beyond a Bachelor's Degree (for example: MD, JD)", 
          N = 0, 
          Freq = "0.00%", 
          .before = 7)
```


```{r Q05 prep, message=FALSE, warning=FALSE}
data.Q05 <- data |>
  select(starts_with("Q5")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q5_1" & is.na(response) ~ "Q5_1",
      variable == "Q5_2" & is.na(response) ~ "Q5_2",
      variable == "Q5_3" & is.na(response) ~ "Q5_3",
      variable == "Q5_4" & is.na(response) ~ "Q5_4",
      variable == "Q5_5" & is.na(response) ~ "Q5_5",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q5_1" ~ "Aging or older adults", 
      Variable == "Q5_2" ~ "Disabilities", 
      Variable == "Q5_3" ~ "Behavioral or mental health", 
      Variable == "Q5_4" ~ "Long-term services and supports", 
      Variable == "Q5_5" ~ "Healthcare administration", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Yes",
      response == 2 ~ "[2] No",
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(3, 1, 2, 
        6, 4, 5, 
        9, 7, 8, 
        12, 10, 11, 
        15, 13, 14)
```


```{r Q06 prep}
data.Q06 <- data |>
  select(starts_with("Q6")) |>
  select(-Q6_6_TEXT) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q6_1" &
        is.na(response) ~ "Q6_1",
      variable == "Q6_2" &
        is.na(response) ~ "Q6_2",
      variable == "Q6_3" &
        is.na(response) ~ "Q6_3",
      variable == "Q6_4" &
        is.na(response) ~ "Q6_4",
      variable == "Q6_5" &
        is.na(response) ~ "Q6_5",
      variable == "Q6_6" & 
       is.na(response) ~ "Q6_6", 
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q6_1" ~ "Nursing home administrator", 
      Variable == "Q6_2" ~ "Registered nurse (RN)", 
      Variable == "Q6_3" ~ "Licensed practical/vocational nurse (LPN/LVN)", 
      Variable == "Q6_4" ~ "Certified nursing assistant (CNA)", 
      Variable == "Q6_5" ~ "Certified medication aide (CMA)", 
      Variable == "Q6_6" ~ "Other certification",
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] No, never",
      response == 2 ~ "[2] Yes, previously",
      response == 3 ~ "[3] Yes, currently",
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(4, 1, 2, 3,
        8, 5, 6, 7,
        12, 9, 10, 11,
        16, 13, 14, 15, 
        20, 17, 18, 19, 
        24, 21, 22, 23)
```


```{r Q07 prep}
data.Q07 <- data |>
  select(Q7) |>
  mutate(response = replace_na(Q7, -99)) |> 
  group_by(response) |> 
  summarise(n = n()) |> 
  transmute(Variable = c("Q7", "", "", "", ""), 
            Option = "", 
            Response = case_when(response == -99 ~ "[-99, NA] Missing", 
                                  response == 1 ~ "[1] 2020", 
                                  response == 2 ~ "[2] 2019", 
                                  response == 3 ~ "[3] 2018", 
                                  response == 4 ~ "[4] 2017 or before"), 
            N = n, 
            Freq = percent(n/sum(n))
            )
```


```{r Q08 prep}
data.Q08 <- data |>
  select(starts_with("Q8")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q8_1" & is.na(response) ~ "Q8_1",
      variable == "Q8_2" & is.na(response) ~ "Q8_2",
      variable == "Q8_3" & is.na(response) ~ "Q8_3",
      variable == "Q8_4" & is.na(response) ~ "Q8_4",
      variable == "Q8_5" & is.na(response) ~ "Q8_5",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q8_1" ~ "Rules and regulations (e.g., health, fire)", 
      Variable == "Q8_2" ~ "Finance, accounting", 
      Variable == "Q8_3" ~ "Human resources and staffing", 
      Variable == "Q8_4" ~ "Physical environment (e.g., building/plant management)", 
      Variable == "Q8_5" ~ "Leadership skills", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Very dissatisfied",
      response == 2 ~ "[2] Dissatisfied",
      response == 3 ~ "[3] Neither satisfied nor dissatisfied", 
      response == 4 ~ "[4] Satisfied", 
      response == 5 ~ "[5] Very satisfied", 
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(6, 1, 2, 3, 4, 5, 
        12, 7, 8, 9, 10, 11, 
        18, 13, 14, 15, 16, 17, 
        24, 19, 20, 21, 22, 23, 
        30, 25, 26, 27, 28, 29)
```


```{r Q09 prep}
data.Q09 <- data |>
  select(starts_with("Q9")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q9_1" & is.na(response) ~ "Q9_1",
      variable == "Q9_2" & is.na(response) ~ "Q9_2",
      variable == "Q9_3" & is.na(response) ~ "Q9_3",
      variable == "Q9_4" & is.na(response) ~ "Q9_4",
      variable == "Q9_5" & is.na(response) ~ "Q9_5",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q9_1" ~ "My training sufficiently prepared me for this position.", 
      Variable == "Q9_2" ~ "I received sufficient onboarding support (e.g., mentorship) when I started this position.", 
      Variable == "Q9_3" ~ "There are sufficient ongoing training opportunities for me.", 
      Variable == "Q9_4" ~ "The existing opportunities for continuing education are relevant to my work.", 
      Variable == "Q9_5" ~ "My employer makes it possible for me to attend training (e.g., paid time for training).", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Strongly disagree",
      response == 2 ~ "[2] Disagree",
      response == 3 ~ "[3] Neither agree nor disagree", 
      response == 4 ~ "[4] Agree", 
      response == 5 ~ "[5] Strongly agree", 
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(6, 1, 2, 3, 4, 5, 
        12, 7, 8, 9, 10, 11, 
        18, 13, 14, 15, 16, 17, 
        24, 19, 20, 21, 22, 23, 
        30, 25, 26, 27, 28, 29)
```


```{r Q10a prep}
data.Q10a <- data |>
  select(Q10a) |>
  mutate(response = replace_na(Q10a, -99)) |> 
  group_by(response) |> 
  summarise(n = n()) |> 
  transmute(Variable = c("Q10a", "", ""), 
            Option = "", 
            Response = case_when(response == -99 ~ "[-99, NA] Missing", 
                                  response == 1 ~ "[1] Yes", 
                                  response == 2 ~ "[2] No"), 
            N = n, 
            Freq = percent(n/sum(n))
            )
```


```{r Q11 prep}
data.Q11 <- data |>
  mutate(Q11 = case_when(Q11 == 2017 ~ 3,
                         Q11 == 20192020 ~ 1,
                         Q11 == -99 ~ NA_real_,
                         TRUE ~ Q11)) |>
  skim(Q11) |>
  as_tibble() |>
  transmute(
    Variable = "Q11",
    Missing = n_missing,
    Freq = percent(complete_rate, accuracy = 0.1),
    Mean = round(numeric.mean, 1),
    SD = round(numeric.sd, 1),
    P0 = numeric.p0,
    P25 = numeric.p25,
    P50 = numeric.p50,
    P75 = numeric.p75,
    P100 = numeric.p100
  ) 
```


```{r Q12 prep}
data.Q12 <- data |>
  select(Q12) |>
  mutate(response = replace_na(Q12, -99)) |> 
  group_by(response) |> 
  summarise(n = n()) |> 
  transmute(Variable = c("Q12", "", ""), 
            Option = "", 
            Response = case_when(response == -99 ~ "[-99, NA] Missing", 
                                  response == 1 ~ "[1] Yes, I worked at this community as [blank]", 
                                  response == 2 ~ "[2] No, I worked at this community as an administrator only"), 
            N = n, 
            Freq = percent(n/sum(n))
            )
```


```{r Q13 prep}
data.Q13 <- data |>
  select(starts_with("Q13")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |> 
  summarise(across(everything(), ~ sum(., na.rm = TRUE))) |> 
  pivot_longer(cols = everything(), 
               names_to = "variable", 
               values_to = "n") |> 
  transmute(Variable = variable, 
            Option = "", 
            Responses = case_when(variable == "Q13_1" ~ "[1] Assisted living/residential care (not endorsed for memory care)", 
                                  variable == "Q13_2" ~ "[1] Memory care community", 
                                  variable == "Q13_3" ~ "[1] No, this is the first community of which I am the administrator."),
            N = n, 
            Freq = percent(n/sum(n))
            )
```


```{r Q14 prep}
data.Q14 <- data |>
  select(Q14) |>
  mutate(response = replace_na(Q14,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("Q14", "", "", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] I transferred to this community in the same organization",
      response == 2 ~ "[2] I quit",
      response == 3 ~ "[3] I was laid off",
      response == 4 ~ "[4] It closed",
      response == 5 ~ "[5] Other"
    ),
    N = n,
    Freq = percent(n / sum(n))
  ) |> 
  add_row(Variable = "", 
          Option = "",
          Response = "[4] It closed", 
          N = 0, 
          Freq = "0.00%", 
          .before = 5)
```


```{r Q15 prep}
data.Q15 <- data |>
  select(starts_with("Q15")) |>
  select(-Q15_7_TEXT) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q15_1" & is.na(response) ~ "Q15_1",
      variable == "Q15_2" & is.na(response) ~ "Q15_2",
      variable == "Q15_3" & is.na(response) ~ "Q15_3",
      variable == "Q15_4" & is.na(response) ~ "Q15_4",
      variable == "Q15_5" & is.na(response) ~ "Q15_5",
      variable == "Q15_6" & is.na(response) ~ "Q15_6", 
      variable == "Q15_7" & is.na(response) ~ "Q15_7", 
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q15_1" ~ "Adult foster/care home", 
      Variable == "Q15_2" ~ "Nursing home", 
      Variable == "Q15_3" ~ "Home health agency (including hospice agency)", 
      Variable == "Q15_4" ~ "Home care", 
      Variable == "Q15_5" ~ "Hospital", 
      Variable == "Q15_6" ~ "Adult day care", 
      Variable == "Q15_7" ~ "Other", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Yes",
      response == 2 ~ "[2] No",
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(3, 1, 2, 
        6, 4, 5, 
        9, 7, 8, 
        12, 10, 11, 
        15, 13, 14, 
        18, 16, 17, 
        21, 19, 20)
```


```{r Q16 prep}
data.Q16 <- data |> 
  mutate(Q16 = case_when(Q16 == "10 years" ~ "10", 
                         Q16 == "11 years" ~ "11", 
                         Q16 == "15 years" ~ "15", 
                         Q16 == "18 years" ~ "18", 
                         Q16 == "19 years" ~ "19", 
                         Q16 == "2 years all with Mosaic" ~ "2", 
                         Q16 == "20 years" ~ "20", 
                         Q16 == "2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020" ~ "20", 
                         Q16 == "20year" ~ "20", 
                         Q16 == "21 years" ~ "21", 
                         Q16 == "23 years" ~ "23", 
                         Q16 == "24 years" ~ "24", 
                         Q16 == "25 yrs" ~ "25", 
                         Q16 == "26 years" ~ "26", 
                         Q16 == "28 yrs" ~ "28", 
                         Q16 == "29 years" ~ "29", 
                         Q16 == "30 years" ~ "30", 
                         Q16 == "40 years" ~ "40", 
                         Q16 == "6 years" ~ "6", 
                         Q16 == "7 years" ~ "7", 
                         Q16 == "8 years" ~ "8", 
                         Q16 == "9 years" ~ "9", 
                         Q16 == "n/a" ~ NA_character_, 
                         Q16 == "-99" ~ NA_character_, 
                         Q16 == "." ~ NA_character_,
                         TRUE ~ Q16)) |> 
  mutate(Q16 = as.numeric(Q16)) |> 
  skim(Q16) |> 
  as_tibble() |> 
  select(n_missing, complete_rate, numeric.mean, numeric.sd, numeric.p0, numeric.p25, numeric.p50, numeric.p75, numeric.p100) |> 
  transmute(Variable = "Q16", 
            Missing = n_missing, 
            Freq = complete_rate, 
            Mean = numeric.mean, 
            SD = numeric.sd, 
            P0 = numeric.p0, 
            P25 = numeric.p25, 
            P50 = numeric.p50, 
            P75 = numeric.p75, 
            P100 = numeric.p100) 
```


```{r Q17 prep}
data.Q17 <- data |>
  select(Q17) |>
  mutate(response = replace_na(Q17,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("Q17", "", "", "", "", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Less than or equal to $24,999",
      response == 2 ~ "[2] $25,000 to $49,999",
      response == 3 ~ "[3] $50,000 to $74,999",
      response == 4 ~ "[4] $75,000 to $99,999",
      response == 5 ~ "[5] $100,000 or greater", 
      response == 6 ~ "[6] Prefer not to answer", 
      response == 7 ~ "[7] Other"
    ),
    N = n,
    Freq = percent(n / sum(n))
  ) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[1] Less than or equal to $24,999", 
          N = 0, 
          Freq = "0.00%") |> 
  arrange(Response)
```


```{r Q18 prep}
data.Q18 <- data |>
  select(starts_with("Q18")) |>
  select(-Q18_9_TEXT) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  transmute(
    Variable = case_when(
      variable == "Q18_1" & is.na(response) ~ "Q18_1",
      variable == "Q18_2" & is.na(response) ~ "Q18_2",
      variable == "Q18_3" & is.na(response) ~ "Q18_3",
      variable == "Q18_4" & is.na(response) ~ "Q18_4",
      variable == "Q18_5" & is.na(response) ~ "Q18_5",
      variable == "Q18_6" & is.na(response) ~ "Q18_6", 
      variable == "Q18_7" & is.na(response) ~ "Q18_7", 
      variable == "Q18_8" & is.na(response) ~ "Q18_8", 
      variable == "Q18_9" & is.na(response) ~ "Q18_9",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q18_1" ~ "Health insurance for you", 
      Variable == "Q18_2" ~ "Health insurance that includes family coverage", 
      Variable == "Q18_3" ~ "Paid personal time off or vacation time", 
      Variable == "Q18_4" ~ "Paid sick leave", 
      Variable == "Q18_5" ~ "Paid holidays", 
      Variable == "Q18_6" ~ "Pension", 
      Variable == "Q18_7" ~ "A 401(k) or 403(b) account", 
      Variable == "Q18_8" ~ "Life insurance", 
      Variable == "Q18_9" ~ "Bonus or incentive pay for (e.g., census/occupancy, incident reports). Please describe", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Yes",
      response == 2 ~ "[2] No",
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(3, 1, 2, 
        6, 4, 5,  
        9, 7, 8,  
        12, 10, 11,  
        15, 13, 14,  
        18, 16, 17,  
        21, 19, 20,  
        24, 22, 23,  
        27, 25, 26)
```


```{r Q19 prep}
data.Q19 <- data |>
  select(starts_with("Q19")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  arrange( match(variable, c("Q19_1", "Q19_2", "Q19_3", "Q19_4", "Q19_5", 
                             "Q19_6", "Q19_7", "Q19_8", "Q19_9", "Q19_10", 
                             "Q19_11", "Q19_12", "Q19_13", "Q19_14"))) |> 
  transmute(
    Variable = case_when(
      variable == "Q19_1" & is.na(response) ~ "Q19_1",
      variable == "Q19_2" & is.na(response) ~ "Q19_2",
      variable == "Q19_3" & is.na(response) ~ "Q19_3",
      variable == "Q19_4" & is.na(response) ~ "Q19_4",
      variable == "Q19_5" & is.na(response) ~ "Q19_5",
      variable == "Q19_6" & is.na(response) ~ "Q19_6",
      variable == "Q19_7" & is.na(response) ~ "Q19_7",
      variable == "Q19_8" & is.na(response) ~ "Q19_8",
      variable == "Q19_9" & is.na(response) ~ "Q19_9",
      variable == "Q19_10" & is.na(response) ~ "Q19_10",
      variable == "Q19_11" & is.na(response) ~ "Q19_11",
      variable == "Q19_12" & is.na(response) ~ "Q19_12",
      variable == "Q19_13" & is.na(response) ~ "Q19_13",
      variable == "Q19_14" & is.na(response) ~ "Q19_14",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q19_1" ~ "The amount of job security I have.", 
      Variable == "Q19_2" ~ "The amount of pay and fringe benefits I receive.", 
      Variable == "Q19_3" ~ "The amount of personal growth and development I get in doing my job.", 
      Variable == "Q19_4" ~ "The people I talk to and work with on my job.", 
      Variable == "Q19_5" ~ "The degree of respect and fair treatment I receive from my boss.", 
      Variable == "Q19_6" ~ "The feeling of worthwhile accomplishment I get from doing my job.", 
      Variable == "Q19_7" ~ "The chance to get to know other people while on the job.", 
      Variable == "Q19_8" ~ "The amount of support and guidance I receive from my supervisor.", 
      Variable == "Q19_9" ~ "The degree to which I am fairly paid for what I contribute to this organization.", 
      Variable == "Q19_10" ~ "The amount of independent thought and action I can exercise in my job.", 
      Variable == "Q19_11" ~ "How secure things look for me in the future in this organization.", 
      Variable == "Q19_12" ~ "The chance to help other people while at work.", 
      Variable == "Q19_13" ~ "The amount of challenges in my job.", 
      Variable == "Q19_14" ~ "The overall quality of the supervision I receive in my work.", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Very dissatisfied",
      response == 2 ~ "[2] Dissatisfied",
      response == 3 ~ "[3] Neither satisfied nor dissatisfied", 
      response == 4 ~ "[4] Satisfied", 
      response == 5 ~ "[5] Very satisfied", 
      response == 6 ~ "[6] Not applicable",
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(7, 1, 2,  3,  4,  5,  6,
        14, 8, 9, 10, 11, 12, 13, 
        21, 15, 16, 17, 18, 19, 20, 
        26, 22, 23, 24, 25, 
        33, 27, 28, 29, 30, 31, 32, 
        39, 34, 35, 36, 37, 38, 
        45, 40, 41, 42, 43, 44, 
        52, 46, 47, 48, 49, 50, 51, 
        59, 53, 54, 55, 56, 57, 58, 
        65, 60, 61, 62, 63, 64, 
        71, 66, 67, 68, 69, 70, 
        76, 72, 73, 74, 75, 
        82, 77, 78, 79, 80, 81, 
        89, 83, 84, 85, 86, 87, 88) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[1] Very dissatisfied", 
          N = 0, 
          Freq = "0.00%", 
          .before = 23) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 27) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 40) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 46) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 66) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 72) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[1] Very dissatisfied", 
          N = 0, 
          Freq = "0.00%", 
          .before = 73) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 77) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[6] Not applicable", 
          N = 0, 
          Freq = "0.00%", 
          .before = 83)
```


```{r Q20 prep}
data.Q20 <- data |>
  select(starts_with("Q20")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  arrange( match(variable, c("Q20_1", "Q20_2", "Q20_3", "Q20_4", "Q20_5", 
                             "Q20_6", "Q20_7", "Q20_8", "Q20_9", "Q20_10", 
                             "Q20_11", "Q20_12", "Q20_13", "Q20_14", "Q20_15"))) |> 
  transmute(
    Variable = case_when(
      variable == "Q20_1" & is.na(response) ~ "Q20_1",
      variable == "Q20_2" & is.na(response) ~ "Q20_2",
      variable == "Q20_3" & is.na(response) ~ "Q20_3",
      variable == "Q20_4" & is.na(response) ~ "Q20_4",
      variable == "Q20_5" & is.na(response) ~ "Q20_5",
      variable == "Q20_6" & is.na(response) ~ "Q20_6",
      variable == "Q20_7" & is.na(response) ~ "Q20_7",
      variable == "Q20_8" & is.na(response) ~ "Q20_8",
      variable == "Q20_9" & is.na(response) ~ "Q20_9",
      variable == "Q20_10" & is.na(response) ~ "Q20_10",
      variable == "Q20_11" & is.na(response) ~ "Q20_11",
      variable == "Q20_12" & is.na(response) ~ "Q20_12",
      variable == "Q20_13" & is.na(response) ~ "Q20_13",
      variable == "Q20_14" & is.na(response) ~ "Q20_14",
      variable == "Q20_15" & is.na(response) ~ "Q20_15",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q20_1" ~ "I feel a strong sense of 'belonging' to my organization.", 
      Variable == "Q20_2" ~ "My organization really cares about my wellbeing.", 
      Variable == "Q20_3" ~ "I feel like 'part of the family' at this organization.", 
      Variable == "Q20_4" ~ "Help is available from my organization when I have a problem.", 
      Variable == "Q20_5" ~ "My job at this organization is secure.", 
      
      Variable == "Q20_6" ~ "I feel 'emotionally attached' to this organization.", 
      Variable == "Q20_7" ~ "I would feel guilty if I left this organization right now.", 
      Variable == "Q20_8" ~ "My organization strongly considers my goals and values.", 
      Variable == "Q20_9" ~ "I owe a great deal to this organization.", 
      Variable == "Q20_10" ~ "I am confident that I will be able to work for this organization as long as I wish.", 
      
      Variable == "Q20_11" ~ "I frequently think of quitting my current job.", 
      Variable == "Q20_12" ~ "It would be very hard for me to leave my job right now even if I wanted to.", 
      Variable == "Q20_13" ~ "Right now, staying with my job at this organization is a matter of necessity as much as desire.", 
      Variable == "Q20_14" ~ "I will probably look for another job in the next year.", 
      Variable == "Q20_15" ~ "There is a good chance that I will leave this job in the next year or so.", 
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Strongly disagree",
      response == 2 ~ "[2] Disagree",
      response == 3 ~ "[3] Neither agree nor disagree", 
      response == 4 ~ "[4] Agree", 
      response == 5 ~ "[5] Strongly agree", 
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  add_row(Variable = "", 
          Option = "", 
          Response = "[1] Very dissatisfied", 
          N = 0, 
          Freq = "0.00%", 
          .before = 32) |> 
  slice(6, 1, 2,  3,  4,  5, 
        12, 7, 8, 9, 10, 11, 
        18, 13, 14, 15, 16, 17, 
        19, 20, 21, 22, 23, 
        29, 24, 25, 26, 27, 28, 
        35, 30, 31, 32, 33, 34, 
        36, 37, 38, 39, 40, 
        41, 42, 43, 44, 45, 
        46, 47, 48, 49, 50, 
        51, 52, 53, 54, 55, 
        56, 57, 58, 59, 60, 
        61, 62, 63, 64, 65, 
        66, 67, 68, 69, 70, 
        71, 72, 73, 74, 75, 
        76, 77, 78, 79, 80) |> 
  add_row(Variable = "Q20_4", 
          Option = "Help is available from my organization when I have a problem.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 19) |> 
  add_row(Variable = "Q20_7", 
          Option = "I would feel guilty if I left this organization right now.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 37) |> 
  add_row(Variable = "Q20_8", 
          Option = "My organization strongly considers my goals and values.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 43) |> 
  add_row(Variable = "Q20_9", 
          Option = "I owe a great deal to this organization.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 49) |> 
  add_row(Variable = "Q20_10", 
          Option = "I am confident that I will be able to work for this organization as long as I wish.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 55) |> 
  add_row(Variable = "Q20_11", 
          Option = "I frequently think of quitting my current job.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 61) |> 
  add_row(Variable = "Q20_12", 
          Option = "It would be very hard for me to leave my job right now even if I wanted to.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 67) |> 
  add_row(Variable = "Q20_13", 
          Option = "Right now, staying with my job at this organization is a matter of necessity as much as desire.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 73) |> 
  add_row(Variable = "Q20_14", 
          Option = "I will probably look for another job in the next year.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 79) |> 
  add_row(Variable = "Q20_15", 
          Option = "There is a good chance that I will leave this job in the next year or so.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 85)
    
```


```{r Q21 prep}
data.Q21 <- data |>
  select(Q21) |>
  mutate(response = replace_na(Q21,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("Q21", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Yes",
      response == 2 ~ "[2] No"
    ),
    N = n,
    Freq = percent(n / sum(n))
  )
```


```{r Q22 prep}
data.Q22 <- data |>
  select(starts_with("Q22")) |>
  select(-Q22_23_TEXT) |> 
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |> 
  summarise(across(everything(), ~ sum(., na.rm = TRUE))) |> 
  pivot_longer(cols = everything(), 
               names_to = "variable", 
               values_to = "n") |> 
  transmute(Variable = variable, 
            Option = "", 
            Responses = case_when(variable == "Q22_1" ~ "[1] Work-life balance", 
                                  variable == "Q22_2" ~ "[1] Conducting effective meetings", 
                                  variable == "Q22_3" ~ "[1] Being an effective leader", 
                                  variable == "Q22_4" ~ "[1] Leading the change process", 
                                  variable == "Q22_5" ~ "[1] Analyzing and interpreting data", 
                                  variable == "Q22_6" ~ "[1] Informed decision making", 
                                  variable == "Q22_7" ~ "[1] Creating and communicating a vision", 
                                  variable == "Q22_8" ~ "[1] Developing and implementing a strategic plan", 
                                  variable == "Q22_9" ~ "[1] Delegating tasks to others", 
                                  variable == "Q22_10" ~ "[1] Inspiring and motivating staff", 
                                  variable == "Q22_11" ~ "[1] Prioritizing", 
                                  variable == "Q22_12" ~ "[1] Problem solving", 
                                  variable == "Q22_13" ~ "[1] Time management", 
                                  variable == "Q22_14" ~ "[1] Conflict resolution and mediation", 
                                  variable == "Q22_15" ~ "[1] Oral and written communications", 
                                  variable == "Q22_16" ~ "[1] Cultivating effective relationships", 
                                  variable == "Q22_17" ~ "[1] Person-centered care / culture change", 
                                  variable == "Q22_18" ~ "[1] Team building", 
                                  variable == "Q22_19" ~ "[1] Managing teams", 
                                  variable == "Q22_20" ~ "[1] Consensus building", 
                                  variable == "Q22_21" ~ "[1] Active listening", 
                                  variable == "Q22_22" ~ "[1] Coaching, teaching, and mentoring", 
                                  variable == "Q22_23" ~ "[1] Other", 
                                  ),
            N = n, 
            Freq = percent(n/sum(n))
            )
```


```{r Q23 prep}
data.Q23 <- data |>
  select(Q23) |>
  mutate(response = replace_na(Q23,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("", "", "", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Excellent",
      response == 2 ~ "[2] Very good", 
      response == 3 ~ "[3] Good", 
      response == 4 ~ "[4] Fair", 
      response == 5 ~ "[5] Poor"
    ),
    N = n,
    Freq = percent(n / sum(n))
  ) |> 
  add_row(Variable = "Q23", 
          Option = "", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 1)
```


```{r Q24 prep}
data.Q24 <- data |>
  select(Q24) |>
  mutate(response = replace_na(Q24,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("", "", "", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Daily",
      response == 2 ~ "[2] Weekly", 
      response == 3 ~ "[3] Monthly", 
      response == 4 ~ "[4] A few times a year", 
      response == 5 ~ "[5] Never"
    ),
    N = n,
    Freq = percent(n / sum(n))
  ) |> 
  add_row(Variable = "Q24", 
          Option = "", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 1)
```


```{r Q25 prep}
data.Q25 <- data |>
  select(Q25) |>
  mutate(response = replace_na(Q25,-99)) |>
  group_by(response) |>
  summarise(n = n()) |>
  transmute(
    Variable = c("", "", "", "", ""),
    Option = "", 
    Response = case_when(
      response == -99 ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Daily",
      response == 2 ~ "[2] Weekly", 
      response == 3 ~ "[3] Monthly", 
      response == 4 ~ "[4] A few times a year", 
      response == 5 ~ "[5] Never"
    ),
    N = n,
    Freq = percent(n / sum(n))
  ) |> 
  add_row(Variable = "Q25", 
          Option = "", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 1)
```


```{r Q26 prep}
data.Q26 <- data |>
  select(starts_with("Q26")) |>
  mutate(across(everything(), ~ replace(., .x == -99, NA))) |>
  pivot_longer(cols = everything(),
               names_to = "variable",
               values_to = "response") |>
  group_by(variable, response) |>
  summarize(n = n()) |>
  ungroup() |>
  group_by(variable) |>
  mutate(freq = percent(n / sum(n))) |>
  ungroup() |>
  arrange( match(variable, c("Q26_1", "Q26_2", "Q26_3", "Q26_4", "Q26_5", 
                             "Q26_6", "Q26_7", "Q26_8", "Q26_9", "Q26_10"))) |> 
  transmute(
    Variable = case_when(
      variable == "Q26_1" & is.na(response) ~ "Q26_1",
      variable == "Q26_2" & is.na(response) ~ "Q26_2",
      variable == "Q26_3" & is.na(response) ~ "Q26_3",
      variable == "Q26_4" & is.na(response) ~ "Q26_4",
      variable == "Q26_5" & is.na(response) ~ "Q26_5",
      variable == "Q26_6" & is.na(response) ~ "Q26_6",
      variable == "Q26_7" & is.na(response) ~ "Q26_7",
      variable == "Q26_8" & is.na(response) ~ "Q26_8",
      variable == "Q26_9" & is.na(response) ~ "Q26_9",
      variable == "Q26_10" & is.na(response) ~ "Q26_10",
      TRUE ~ ""
    ),
    Option = case_when(
      Variable == "Q26_1" ~ "Working here makes it hard to spend enough time with my family.", 
      Variable == "Q26_2" ~ "Working here leaves little time for other activities.", 
      Variable == "Q26_3" ~ "I have too much work and too little time to do it in.", 
      Variable == "Q26_4" ~ "I sometimes dread the telephone ringing at home because the call might be job-related.", 
      Variable == "Q26_5" ~ "I feel like I never had a day off.", 
      
      Variable == "Q26_6" ~ "There are lots of times when my job drives me right up the wall.", 
      Variable == "Q26_7" ~ "Sometimes when I think about my job I get a tight feeling in my chest.", 
      Variable == "Q26_8" ~ "I feel guilty when I take time off from my job.", 
      Variable == "Q26_9" ~ "My job gets to me more than it should.", 
      Variable == "Q26_10" ~ "I have felt fidgety or nervous as a result of my job.", 
      
      TRUE ~ ""
    ),
    Response = case_when(
      is.na(response) ~ "[-99, NA] Missing",
      response == 1 ~ "[1] Strongly disagree",
      response == 2 ~ "[2] Disagree",
      response == 3 ~ "[3] Neither agree nor disagree", 
      response == 4 ~ "[4] Agree", 
      response == 5 ~ "[5] Strongly agree", 
      TRUE ~ NA_character_
    ),
    N = n,
    Freq = freq
  ) |> 
  filter(!is.na(Response)) |> 
  slice(1, 2,  3,  4,  5, 
        11, 6, 7, 8,  9, 10, 
        12, 13, 14, 15, 16, 
        17, 18, 19, 20, 21, 
        22, 23, 24, 25, 26, 
        32, 27, 28, 29, 30, 31, 
        33, 34, 35, 36, 37, 
        38, 39, 40, 41, 42, 
        48, 43, 44, 45, 46, 47, 
        54, 49, 50, 51, 52, 53) |> 
  add_row(Variable = "Q26_1", 
          Option = "Working here makes it hard to spend enough time with my family.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 1) |> 
  add_row(Variable = "Q26_3", 
          Option = "I have too much work and too little time to do it in.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 13) |> 
  add_row(Variable = "Q26_4", 
          Option = "I sometimes dread the telephone ringing at home because the call might be job-related.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 19) |> 
  add_row(Variable = "Q26_5", 
          Option = "I feel like I never had a day off.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 25) |> 
  add_row(Variable = "Q26_7", 
          Option = "Sometimes when I think about my job I get a tight feeling in my chest.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 37) |> 
  add_row(Variable = "Q26_8", 
          Option = "I feel guilty when I take time off from my job.", 
          Response = "[-99, NA] Missing", 
          N = 0, 
          Freq = "0.00%", 
          .before = 43)
```


```{r}
set_flextable_defaults(
  font.family = "Times New Roman", 
  font.size = 10, 
  theme_fun = theme_booktabs
)
```

\newpage

## firstname

Respondent first name.


## lastname

Respondent last name. 


## position_start

Date respondent started most recent position. 


## position_end

Date respondent ended most recent position; NA if position had not ended by Oct. 01, 2021. 


## ccmu

CCMU of facility. 


## facility_name

Facility name.


## facility_beds

Number of beds in facility. 

```{r}
tab.facility_beds <- flextable(data.facility_beds) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.facility_beds
```


## facility_turnover

Turnover ratio for facility. Calculated by dividing number of administrators by time period years of facility operation. 1 indicates as many new administrators as years of operation, 0 = no new administrators over operation time period.

```{r}
tab.facility_turnover <- flextable(data.facility_turnover) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.facility_turnover
```


## survey_complete

Flag for respondent survey completion.


## response_id

Unique id for each survey respondent.


## Survey Question 1

What is your gender?

```{r}
tab.01 <- flextable(data.Q01) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.01
```

Q1_3_TEXT [3] Prefer to self-describe: 

```{r}
text <- data |> select(Q1_3_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


## Survey Question 2

What is your age? Please enter in years.

```{r}
tab.02 <- flextable(data.Q02) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.02
```


\newpage

## Survey Question 3

What is your race/ethnicity? Please select all that apply.

```{r}
tab.03 <- flextable(data.Q03) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.03
```

Q3_7_TEXT [1] Other: 

```{r}
text <- data |> select(Q3_7_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 4

What is the highest degree or level of school you have COMPLETED?

```{r}
tab.04 <- flextable(data.Q04) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.04
```


\newpage

## Survey Question 5

Did any of your degrees include curriculum or course content related to the following subject areas?

```{r}
tab.05 <- flextable(data.Q05) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.05
```


\newpage

## Survey Question 6

Do you currently have or have you ever had any of the following certifications or licenses?

```{r}
tab.06 <- flextable(data.Q06) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.06
```

Q6_6_TEXT Other certification [1] Yes: 

```{r}
text <- data |> select(Q6_6_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 7

In what year did you last attend the state-approved 40-hour training offered by Leading Age Oregon or Oregon Health Care Association (OHCA)?

```{r}
tab.07 <- flextable(data.Q07) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.07
```


\newpage

## Survey Question 8

How satisfied were you about the different subjects covered in the training program that you attended?

```{r}
tab.08 <- flextable(data.Q08) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.08
```


\newpage

## Survey Question 9

Do you agree or disagree with the following statements?

```{r}
tab.09 <- flextable(data.Q09) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.09
```


\newpage

## Survey Question 10

What is your current job title at this organization (e.g., administrator, CEO, executive director)?

```{r}
text <- data |> select(Q10) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 10a

Do you or a member of your immediate family have partial or full ownership of this community?

```{r}
tab.10a <- flextable(data.Q10a) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.10a
```


\newpage

## Survey Question 11

How long have you been an administrator at this community? Please enter in years.

```{r}
tab.11 <- flextable(data.Q11) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.11
```


\newpage

## Survey Question 12

Have you worked in any other position at this community prior to becoming an administrator?

```{r}
tab.12 <- flextable(data.Q12) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.12
```

Q12_1_TEXT [1] Yes, I worked at this community as [blank]: 

```{r}
text <- data |> select(Q12_1_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 13

Have you ever been an administrator at another assisted living, residential care, or memory care community? Please select all that apply.

```{r}
tab.13 <- flextable(data.Q13) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.13
```


\newpage

## Survey Question 14

What was the reason for leaving your administrator position at that last community?

```{r}
tab.14 <- flextable(data.Q14) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.14
```

Q14_5_TEXT [5] Other: 

```{r}
text <- data |> select(Q14_5_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 15

Have you ever worked in any of the following settings prior to your current job?

```{r}
tab.15 <- flextable(data.Q15) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.15
```

Q15_7_TEXT Other [1] Yes: 

```{r}
text <- data |> select(Q15_7_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 16

Considering your past work experience, how long have you worked in the long-term care or health settings listed above in total? Please include all prior jobs, even if you left and then came back. Please enter in years.

```{r}
tab.16 <- flextable(data.Q16) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.16
```


\newpage

## Survey Question 17

What is your current annual salary in your position as an administrator?

```{r}
tab.17 <- flextable(data.Q17) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.17
```

Q17_7_TEXT [7] Other

```{r}
text <- data |> select(Q17_7_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = ", ")
}

rm(text)
```


\newpage

## Survey Question 18

Which of the following fringe benefits does your current employer offer to you? For each benefit, please indicate whether you are offered the benefit even if you choose not to receive or use it.

```{r}
tab.18 <- flextable(data.Q18) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.18
```

Q18_9_TEXT Bonus or incentive pay for (e.g., census/occupancy, incident reports). Please describe [1] Yes: 

```{r}
text <- data |> select(Q18_9_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 19

This next question asks about how satisfied you are with each aspect of your current job listed below. To what extent are you satisfied or dissatisfied with each aspect of your job? Please select Not Applicable if a particular statement is not applicable to you or your position.

```{r}
tab.19 <- flextable(data.Q19) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.19
```


\newpage

## Survey Question 20

Thinking about the community, management, and ownership where you work, to what extent do you agree or disagree with the following statements?

```{r}
tab.20 <- flextable(data.Q20) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.20
```


\newpage

## Survey Question 21

Are there any job skills you would like to get training for?

```{r}
tab.21 <- flextable(data.Q21) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.21
```


\newpage

## Survey Question 22

Which of the following job skills would you say you would like to get training for? Please select all that apply.

```{r}
tab.22 <- flextable(data.Q22) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.22
```

Q22_23_TEXT [1] Other

```{r}
text <- data |> select(Q22_23_TEXT) |> drop_na()

if(nrow(text) == 0) {
   cat("No responses")
} else {
    cat(paste0(pull(text)), sep = "\n")
}

rm(text)
```


\newpage

## Survey Question 23

Would you say your health in general is excellent, very good, good, fair, or poor?

```{r}
tab.23 <- flextable(data.Q23) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.23
```


\newpage

## Survey Question 24

How often do you feel worried, nervous, or anxious? Would you say daily, weekly, monthly, a few times a year, or never?

```{r}
tab.24 <- flextable(data.Q24) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.24
```


\newpage

## Survey Question 25

How often do you feel depressed? Would you say daily, weekly, monthly, a few times a year, or never?

```{r}
tab.25 <- flextable(data.Q25) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.25
```


\newpage

## Survey Question 26

Following are some statements related to your work. Do you agree or disagree with each statement?

```{r}
tab.26 <- flextable(data.Q26) |> 
  autofit() |> 
  fit_to_width(7.5)

tab.26
```


